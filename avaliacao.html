<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Confirmação de Agendamento</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="card" id="agendamentoCard">
  <!-- Logo -->
  <img src="logo.png" alt="Logo da Clínica Odontológica" class="logo">

  <h2>Agendamento não encontrado</h2>
  <p id="paciente"></p>
  <p id="data"></p>
  <p id="hora"></p>
  <button class="whatsapp" id="btnWhats">Confirmar pelo WhatsApp</button>      
  <button class="agenda" id="btnAgenda">Adicionar ao Google Agenda</button>
</div> 

<script>
  const clinicaWhats = "+5519987687285"; // seu número

  const params = new URLSearchParams(window.location.search);
  let id = params.get("id");

  if (!id) {
    id = "123"; // id de teste
  }
//----------------------------------------------------------------------------------
  const agendamentos = {
    "123": { paciente: "Luana Lucia", data: "11/09/2025", hora: "15:00" },       
    "2": { paciente: "Edmilson", data: "17/09/2025", hora: "13:45" },            
    "19983136004": { paciente: "José", data: "23/09/2025", hora: "09h45"},       
    "19996249782": { paciente: "Maria", data: "23/09/2025", hora: "10h45"},      
    "19997126510": { paciente: "Carine", data: "23/09/2025", hora: "12h45"},     
    "12997631732": { paciente: "Mirany", data: "23/09/2025", hora: "16h45"},     
    "19998892597": { paciente: "Luana", data: "23/09/2025", hora: "11h45"},      
    "19982341497": { paciente: "Milena", data: "24/09/2025", hora: "12h45"},     
    "19971503559": { paciente: "Angela", data: "24/09/2025", hora: "14h45"},
    "11945005003": { paciente: "Arley", data: "25/09/2025", hora: "14h00"},
    "19999775246": { paciente: "Rafaela", data: "25/09/2025", hora: "17h30"},
    "19989341628": { paciente: "Lory", data: "26/09/2025", hora: "08h00"},
    "19993286376": { paciente: "Cibele", data: "26/09/2025", hora: "09h15"},
    "19988671244": { paciente: "Márcia", data: "26/09/2025", hora: "12h45"},
    "12997631732": { paciente: "Mirany", data: "26/09/2025", hora: "16h45"},
    "19995270018": { paciente: "Carla", data: "26/09/2025", hora: "08h45"},
    "19998792333": { paciente: "José", data: "26/09/2025", hora: "10h30"},
    "11982982537": { paciente: "Vanuza", data: "26/09/2025", hora: "14h45"},
    "19981247848": { paciente: "Raquel", data: "26/09/2025", hora: "13h30"},
    "19982341497": { paciente: "Milena", data: "29/09/2025", hora: "09h30"},
    "13988160487": { paciente: "Maria", data: "29/09/2025", hora: "10h45"},
    "19988931930": { paciente: "Regina", data: "29/09/2025", hora: "10h45"},
    "19993938846": { paciente: "Dayana", data: "29/09/2025", hora: "13h15"},
    "19983323152": { paciente: "Bárbara", data: "29/09/2025", hora: "15h45"},
    "19996968442": { paciente: "Roberto", data: "30/09/2025", hora: "13h30"},
    "19971617182": { paciente: "Isabel", data: "30/09/2025", hora: "14h45"},
    "19991004136": { paciente: "Adriana", data: "30/09/2025", hora: "16h45"},
fds
    //https://asenseodontologia.github.io/avaliacao/avaliacao.html?id=
  };
//------------------------------------------------------------------------------------
  const agendamento = agendamentos[id];

  const card = document.getElementById("agendamentoCard");
  const pacienteEl = document.getElementById("paciente");
  const dataEl = document.getElementById("data");
  const horaEl = document.getElementById("hora");
  const btnWhats = document.getElementById("btnWhats");
  const btnAgenda = document.getElementById("btnAgenda");

  // Função para formatar a data/hora no padrão que o Google Agenda entende
  const formatDateLocal = (d) => {
    const ano = d.getFullYear();
    const mes = String(d.getMonth() + 1).padStart(2, "0");
    const dia = String(d.getDate()).padStart(2, "0");
    const hora = String(d.getHours()).padStart(2, "0");
    const min = String(d.getMinutes()).padStart(2, "0");
    return `${ano}${mes}${dia}T${hora}${min}00`;
  };

  // Novo: Função para padronizar a hora (substitui 'h' por ':')
  const padronizarHora = (horaString) => {
    // Troca 'h' por ':' e remove qualquer caractere que não seja número ou ':'
    return horaString.replace("h", ":").replace(/[^0-9:]/g, "");
  };


  if (agendamento) {
    card.querySelector("h2").textContent = "Confirmação de Agendamento";
    pacienteEl.textContent = "Paciente: " + agendamento.paciente;
    dataEl.textContent = "Data: " + agendamento.data;
    horaEl.textContent = "Horário: " + agendamento.hora;

    btnWhats.onclick = () => {
      const mensagem = `Olá, boa tarde, eu ${agendamento.paciente}, confirmo meu agendamento para o dia ${agendamento.data} às ${agendamento.hora}.`;
      window.open(`https://wa.me/${clinicaWhats}?text=${encodeURIComponent(mensagem)}`, "_blank");
    };

    btnAgenda.onclick = () => {
      const dataSplit = agendamento.data.split("/");
      
      // Usa a nova função para garantir o formato HH:MM
      const horaPadronizada = padronizarHora(agendamento.hora);
      const horaSplit = horaPadronizada.split(":");
      
      // Ordem: Ano, Mês (base 0), Dia, Hora, Minuto
      // dataSplit[1]-1 é necessário para o mês (0=Jan, 11=Dez)
      const start = new Date(dataSplit[2], dataSplit[1]-1, dataSplit[0], horaSplit[0], horaSplit[1]);
      const end = new Date(start.getTime() + 30*60*1000);  // Adiciona 30 minutos

      const url = `https://www.google.com/calendar/render?action=TEMPLATE&text=Consulta Dentista - ${agendamento.paciente}&dates=${formatDateLocal(start)}/${formatDateLocal(end)}&details=Agendamento confirmado&sf=true&output=xml`;
      window.open(url, "_blank");
    };
  }
</script>














